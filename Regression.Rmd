---
title: "Untitled"
author: "Groupe 1"
date: '2025-09-04'
output: pdf_document
---

```{r}
df <- data.frame(Note = c(15, 13, 11, 9, 7),
                 Age = c(18, 19, 20, 21, 22))
modele1 <- lm(Note ~ Age, data = df)
summary(modele1)

```

```{r}
df <- data.frame(Sexe = c("M", "M", "F", "F", "F"),
                 Note = c(10, 12, 14, 16, 15))
# Convertir le sexe en numérique
library(dplyr)
df <- df |> mutate(Sexe_numerique = ifelse(Sexe == "F", 1, 0))
modele2 <- lm(Note ~ Sexe_numerique, data = df)
modele2
```

```{r}
# Calculer les résidus
residus1 <- residuals(modele1)
ajustes1 <- fitted(modele1)
```

```{r}
# Graphique des résidus
plot(ajustes1, residus1, main = "Graphique des Résidus", 
     xlab = "Valeurs Ajustées", ylab = "Résidus")
abline(h = 0, col = "red", lty = 2)

```

```{r}
 # Créer des données d'exemple
 set.seed(123)
 n <- 20
 donnees <- data.frame(
  Note = round(rnorm(n, 14, 3), 1),
  Age = sample(17:22, n, replace = TRUE),
  Sexe = sample(c("M", "F"), n, replace = TRUE),
  Heures_etude = round(runif(n, 5, 25), 1)
 )
 # Convertir Sexe en variable numérique
 donnees$Sexe_num <- ifelse(donnees$Sexe == "F", 1, 0)
 # Afficher les premières lignes
 head(donnees)
```

```{r}
 # Modèle avec Age et Sexe
 modele_multiple <- lm(Note ~ Age + Sexe_num, data = donnees)
 summary(modele_multiple)
 # Modèle avec toutes les variables
 modele_complet <- lm(Note ~ Age + Sexe_num + Heures_etude, data = donnees)
 summary(modele_complet)
```

```{r}
 # R fait automatiquement cette omission
 modele_sexe <- lm(Note ~ Sexe, data = donnees)
 summary(modele_sexe)
 # Pour voir les niveaux de la variable
 levels(factor(donnees$Sexe))
```

```{r}
 # Comparer R² et R² ajusté
 modele1 <- lm(Note ~ Age, data = donnees)
 modele2 <- lm(Note ~ Age + Sexe_num, data = donnees)
 modele3 <- lm(Note ~ Age + Sexe_num + Heures_etude, data = donnees)
 # Extraire R² et R² ajusté
 summary(modele1)$r.squared
 summary(modele1)$adj.r.squared
 summary(modele2)$r.squared
 summary(modele2)$adj.r.squared
 summary(modele3)$r.squared
 summary(modele3)$adj.r.squared
```

```{r}
 # Installer et charger le package nécessaire
 # install.packages("MASS")
 library(MASS)
 # Modèle complet comme point de départ
 modele_complet <- lm(Note ~ Age + Sexe_num + Heures_etude, data = donnees)
 # Sélection stepwise
 selection_step <- stepAIC(modele_complet, direction = "both")
 summary(selection_step)
 # Sélection forward
 modele_vide <- lm(Note ~ 1, data = donnees)
 selection_forward <- stepAIC(modele_vide, 
scope = list(upper = modele_complet),
 direction = "forward")
 # Sélection backward
 selection_backward <- stepAIC(modele_complet, direction = "backward")
```

```{r}
# Génerer des données plus réalistes
 set.seed(456)
 n <- 100
 eleves <- data.frame(
 Age = round(runif(n, 16, 23), 1),
 Sexe = sample(c("M", "F"), n, replace = TRUE, prob = c(0.45, 0.55)),
 Heures_etude = round(runif(n, 5, 30), 1),
 Distance_ecole = round(runif(n, 1, 20), 1),
 Education_parents = sample(1:4, n, replace = TRUE)
 )
 # Générer les notes avec des relations réalistes
 eleves$Note <- round(
 8 + -0.3 * eleves$Age + 
2 * (eleves$Sexe == "F") + 
0.15 * eleves$Heures_etude + -0.1 * eleves$Distance_ecole + 
0.8 * eleves$Education_parents + 
rnorm(n, 0, 2), 1
 )
 # Assurer que les notes sont dans la plage 0-20
 eleves$Note <- pmax(0, pmin(20, eleves$Note))
 # Analyse exploratoire
 summary(eleves)
 cor(eleves[c("Note", "Age", "Heures_etude", "Distance_ecole", "Education_parents")])
 # Modèles progressifs
 modele_simple <- lm(Note ~ Age, data = eleves)
 modele_2var <- lm(Note ~ Age + Sexe, data = eleves)
 modele_complet <- lm(Note ~ Age + Sexe + Heures_etude + Distance_ecole + Education_parents, data =eleves)
 # Comparaison des modèles
 anova(modele_simple, modele_2var, modele_complet)
 # Sélection automatique
 selection_finale <- stepAIC(modele_complet, direction = "both")
 summary(selection_finale)
```
